<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
<head>
  <meta charset="UTF-8">
  <title>在庫管理 - 商品編集</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/style2.css}">
</head>
<body>

	<aside>
	  <h1>納品書</h1>
	  <a th:href="@{/index}" class="aside-btn">TOPへ</a>
	  <a th:href="@{/delivery-top}" class="aside-btn">ダッシュボード</a>
	  <a th:href="@{/create-delivery-slip-step1}" class="aside-btn">納品書作成</a>
	  <a th:href="@{/delivery-history}" class="aside-btn">納品履歴</a>
	  <a th:href="@{/company}" class="aside-btn">会社情報</a>
	</aside>

  <div class="main-content">
	<div class="card-title">
	    <h2>納品書作成</h2>
	</div>
    <div class="complete-box" style="margin-top: 15rem;">
      <p class="complete-message">登録が完了しました。</p>
	  <input type="hidden" id="deliverySlipId" th:value="${deliverySlipId}">
	  <input type="hidden" id="deliveryCheck" th:value="${deliveryCheck}">
      <a th:href="@{create-delivery-slip-step1}" class="btn btn-secondary form-btn">戻る</a>
	  <a id="downloadLink" th:href="@{'/download-delivery-slip-preview?id=' + ${deliverySlipId}}" target="_blank" style="display: none;">Download</a>

    </div>
  </div>
  <script th:inline="javascript">
    /*<![CDATA[*/
  //  const slipId = [[${deliverySlipId} != null ? deliverySlipId : 0]];
  document.addEventListener("DOMContentLoaded", function () {
  	const slipId = Number(document.getElementById("deliverySlipId").value);
      const checkList = document.getElementById("deliveryCheck").value;
	  const downloadChecked = checkList
	          .replace(/^\[|\]$/g, '').split(',').map(s => s.trim()); 
	  console.log(slipId);
	  console.log(checkList);
	  console.log(downloadChecked);
      if (downloadChecked.includes("download")) {
 		   document.getElementById("downloadLink").click();
      } 
    });
    /*]]>*/
  </script>
</body>
</html>